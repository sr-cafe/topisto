{"version":3,"sources":["../src/index.es6"],"names":[],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AAEA;;;;AACA;;;;;;;;AAEA,IAAI,KAAK,mBAAQ,YAAR,CAAqB,QAAQ,IAAR,CAArB,CAAL;;AAEJ,IAAI,qBAAqB,SAArB,kBAAqB,CAAS,MAAT,EAAiB,WAAjB,EAA6B;AACrD,QAAO,kBAAQ,kBAAR,CAA2B,WAA3B,EAAwC,MAAxC,CAAP,CADqD;CAA7B;;AAIzB,IAAI,cAAc,SAAd,WAAc,CAAS,QAAT,EAAkB;AACnC,QAAO,GAAG,aAAH,CAAiB,QAAjB,EAA2B,EAAC,UAAS,MAAT,EAA5B,EACL,IADK,CACA,UAAS,OAAT,EAAiB;AACtB,MAAI,SAAS,eAAK,OAAL,CAAa,qBAAqB,QAArB,CAAb,CAAT;MACH,OAAO,eAAK,QAAL,CAAc,QAAd,CAAP,CAFqB;AAGtB,SAAO,mBAAS,OAAT,EAAkB,IAAlB,EAAwB,MAAxB,EAAgC,KAAhC,EAAP,CAHsB;EAAjB,CADP,CADmC;CAAlB;;AASlB,IAAI,uBAAuB,kBAAQ,iBAAR,CAA0B,QAAQ,GAAR,EAA1B,CAAvB;;;AAGJ,IAAI,gBAAgB,SAAhB,aAAgB,GAAU;AAC7B,QAAO,QAAQ,UAAR,CADsB;CAAV;;IAIC;;;sBACI;AAAE,UAAO,CAAC,KAAD,CAAP,CAAF;;;;AAExB,UAHoB,OAGpB,GAAa;wBAHO,SAGP;;;;;AAIZ,OAAK,OAAL,GAAe,CACd,eAAK,IAAL,CAAU,QAAQ,GAAR,EAAV,EAAyB,KAAzB,CADc,CAAf,CAJY;;AAQZ,OAAK,UAAL,GAAkB,eAAlB,CARY;EAAb;;cAHoB;;wBAcf;AACJ,UAAO,mBAAQ,MAAR,CAAe,KAAK,OAAL,EAAc,kBAA7B,EAAiD,EAAjD,EACL,MADK,CACE,kBAAQ,oBAAR,CAA6B,KAAK,UAAL,CAD/B,EAEL,GAFK,CAED,WAFC,EAGL,MAHK,CAGE,UAAS,IAAT,EAAc;AACrB,WAAO,KAAK,WAAL,IAAoB,KAAK,WAAL,CAAiB,MAAjB,CADN;IAAd,CAHT,CADI;;;;QAde","file":"index.js","sourcesContent":["import path from 'path';\nimport Promise from 'bluebird';\n\nimport File from './core/file';\nimport helpers from './helpers';\n\nlet fs = Promise.promisifyAll(require(\"fs\"));\n\nlet directoriesReducer = function(result, currentPath){\n\treturn helpers.listDirectoryFiles(currentPath, result);\n};\n\nlet filesMapper = function(filePath){\n\treturn fs.readFileAsync(filePath, {encoding:'utf8'})\n\t\t.then(function(content){\n\t\t\tlet folder = path.dirname(getPathRelativeToCWD(filePath)),\n\t\t\t\tname = path.basename(filePath);\n\t\t\treturn new File(content, name, folder).parse();\n\t\t});\n};\n\nlet getPathRelativeToCWD = helpers.getPathRelativeTo(process.cwd());\n\n// TODO Implement injection of extensions via command line\nlet getExtensions = function(){\n\treturn Topisto.EXTENSIONS;\n}\n\nexport default class Topisto{\n\tstatic get EXTENSIONS() { return ['es6'] }\n\n\tconstructor(){\n\t\t// TODO Read command line arguments\n\t\t// TODO Allow excluded folders\n\t\t// NOTE Is \"process.cwd()\" necessary?\n\t\tthis.folders = [\n\t\t\tpath.join(process.cwd(), 'src')\n\t\t];\n\n\t\tthis.extensions = getExtensions();\n\t}\n\n\trun(){\n\t\treturn Promise.reduce(this.folders, directoriesReducer, [])\n\t\t\t.filter(helpers.filterWithExtensions(this.extensions))\n\t\t\t.map(filesMapper)\n\t\t\t.filter(function(file){\n\t\t\t\treturn file.annotations && file.annotations.length;\n\t\t\t});\n\t}\n}\n"]}